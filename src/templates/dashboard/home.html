{% extends "base.html" %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>

<div class="ui container centered grid">
	<div class="eleven wide column segment" style="margin-top: 50px">
		<div class="row" style="margin-bottom: 20px;">
  			<h1 class="ui header" align="left">Dashboard
  			<div class="sub header"><small>Welcome, <strong>{{ current_user.username }} </strong> 
  			&nbsp;({% if current_user.is_admin %}Administrator{% elif not current_user.is_admin %}Regular user{% endif %})
			</small></div></h1>
		</div>
		<div class="row">
		<div class="ui secondary menu" style="border-bottom: 2px solid rgba(34, 36, 38, 0.15);"	>
	  <a class="active item" href={% url 'dashboard:home' %}>Home</a>
	  <a class="item" href={% url 'dashboard:institution-list' %}>View institutions</a>
	  <a class="item" href={% url 'users:update' %}>Edit My Profile</a>

	  <div class="right secondary menu">
	    <a class="ui item" href={% url 'logout' %}> <i class="sign out icon"></i> Logout</a>
	  </div>

	</div>
</div>
<div class="row">
	<p></p>
 	<div class="ui grid">
  <div class="row">
    <div class="sixteen wide column">
      <div class="ui horizontal segments">
        <div class="ui secondary vertical pointing menu">
          <a class="active item">Appointments</a>
          <a class="item">Services</a>
          <a class="item">Companies</a>
          <a class="item">Links</a>
        </div>
        <div class="ui segment" style="border-left-width: 0px;">
          <h2>Scheduled Appointments</h2>
			{% if appointments %}
				<ul>
					{% for aptmt in appointments %}
						<li> 
							{{ aptmt }} 
							{% if current_user.is_admin %} 
							<a href="{% url 'appointments:status' appointment_id=aptmt.appointment_id %}?s=Cancelled">Cancel</a> {% endif %}
						</li>
					{% endfor %}
				</ul>
			{% else %}
			<p>No scheduled appointments.</p>
			{% endif %}

			<h2>Pending Appointments</h2>
			{% if pending_appointments %}
				<ul>
					{% for aptmt in pending_appointments %}
						<li>
							{{ aptmt }} 
							
							{% if current_user.is_admin %} 
								<a href="{% url 'appointments:status' appointment_id=aptmt.appointment_id %}?s=Accepted">Accept</a> 
								<a href="{% url 'appointments:status' appointment_id=aptmt.appointment_id %}?s=Rejected">Reject</a> 
							{% endif %}
						</li>
					{% endfor %}
				</ul>

			{% else %}
			<p>No pending appointments.</p>
			{% endif %}
        </div>
      </div>
    </div>
  </div>

	</div>

		<p></p>

	

		{% if user.is_admin %}
		<div class="ui grid container center aligned" style="margin-top: 50px">
			<div class="two column row">
				<div class="column">	
					<div class="ui basic segment">
							<h1>Services Offered</h1>
							<a href="{% url 'dashboard:services' %}">Manage Services</a>
							<ul>
							{% for instance in my_services %}
								<li>{{ instance.service.name }}: {{ instance.price }} </li>
							{% endfor %}
							</ul>
					</div>
				</div>
				<div class="ui vertical divider">and</div>
				<div class="column">
					<div class="ui basic segment">
						<h1>Products Offered</h1>
						<a href="{% url 'dashboard:products' %}">Manage Products</a>
						<ul>
							{% for instance in my_products %}
								<li>{{ instance.product.generic_name }} / {{ instance.product.brand_name }} by {{ instance.product.manufacturer }}: 
									{{ instance.price }} {{ instance.stock }} {{ instance.description }}
								</li>
							{% endfor %}
						</ul>
					</div>
				</div>
			</div>
		</div>
		{% endif %}
	</div>
</div>
</div>
{% endblock %}


<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.6/semantic.js"></script>
<script src="https://cdn.jsdelivr.net/semantic-ui/2.2.13/semantic.min.js"></script>

<script type="text/javascript">

function hey(){
   $('.ui .item').on('click', function() {
      $('.ui .item').removeClass('active');
      $(this).addClass('active');
   });             
});

$(document).ready(function(){
   $('.ui .item').on('click', function() {
      $('.ui .item').removeClass('active');
      $(this).addClass('active');
   });             
});

	$('.tabular.menu .item').tab();
</script>